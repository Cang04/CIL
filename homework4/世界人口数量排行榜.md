### 世界人口数量排行榜



#### 调用bar_chart_race库，制作动态排行榜

1. **带国旗标志**

   ```python
   # 导入模块
   import pandas as pd
   import bar_chart_race as bcr
   import flag as ecf
   
   # 创建数据框
   df = pd.DataFrame({
       'year': [1960, 1965, 1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010, 2015, 2020],
       'China': [667070000, 715185000, 818315000, 916395000, 981235000, 1058510000, 1135185000, 1210855000, 1262645000, 1299940000, 1340960000, 1371220000, 1397715000],
       'India': [449480000, 494798000, 553578000, 621301000, 696783000, 781596000, 873277000, 960581000, 1038739000, 1101832000, 1173109000, 1310152000, 1380004000],
       'USA': [180671000, 194303000, 209513000, 215973000, 227225000, 238466000, 249623000 ,262803000 ,282162411 ,295516599 ,309349689 ,321418820 ,331002651],
       'Indonesia': [87792512 ,99028000 ,114793178 ,136725000 ,164982451 ,181413402 ,197577430 ,211540428 ,214448875 ,222781023 ,237641326 ,257563815 ,273523615],
       'Brazil': [72179226 ,82869700 ,95113265 ,107216205 ,121740438 ,135274080 ,149003223 ,161790182 ,174790340 ,184010409 ,194946470 ,204471769 ,212559417],
       'Russia': [119897000 ,125345604 ,129941789 ,137403041 ,138647248 ,141668836 ,148375787 ,147915361 ,146596557 ,143953092 ,142849449 ,143455918 ,145934462],
       'Mexico': [38174112 ,46111000 ,55984294.6 ,63759976.8 ,68434628.7 ,75895675.8 ,84473739.9 ,93007627.1 ,98864658.4 ,103263388.2 ,107449525.4 ,119938473.1 ,128932753],
       'Germany': [72814900.2,75695073.7,78169289.5,78688452,78288576,77718298,79433029,81678051,82211508,82431390,81776930,81686611,83783942],
       'UK': [52410496,53292000,55632000,56079000,56314216,56333829,57442167,58487141,58892514,60401206,62766365,65110034,67886011],
       'Japan': [92500572,98676292,104345817,111940314,117060396,121048923,123611167,125757788,126843659,127767994,128057352,127131800,126476461]
   })
   
   # 设置索引为年份
   df = df.set_index('year')
   
   # 创建国家代码和国旗图标的字典
   countries = df.columns
   name_to_code = {
       'China': 'CHN',
       'India': 'IND',
       'USA': 'USA',
       'Indonesia': 'IDN',
       'Brazil': 'BRA',
       'Russia': 'RUS',
       'Mexico': 'MEX',
       'Germany': 'DEU',
       'UK': 'GBR',
       'Japan': 'JPN'
   }
   
   # 用字典中的代码替换国家名称
   codes = []
   flags = []
   for country in countries:
    code = name_to_code[country] # 获取国家的三位字母代码
    codes.append(code)
    flag = ecf.flag(code) # 使用emoji_country_flag库转换代码为国旗图标
    flags.append(flag)
   # 创建一个新的数据框，用国旗图标替换国家名称
   df_flags = df.copy()
   df_flags.columns = flags
   
   # 制作动态人口数量排行榜，并保存为HTML文件
   html = bcr.bar_chart_race(
    df=df_flags,
    # 设置一些参数
    n_bars=10, # 显示前十个国家
    steps_per_period=10, # 每个时间段显示十帧
    period_length=500, # 每个时间段持续500毫秒
    title='Population——2021300959 cang', # 设置标题
    figsize=(8, 5), # 设置图形大小
    bar_label_size=7, # 设置条形图标签的字体大小
    tick_label_size=7, # 设置刻度标签的字体大小
    bar_kwargs={'alpha': 0.7}, # 设置条形图的透明度
    filter_column_colors=True # 设置条形图的颜色根据国旗图标变化
   )
   
   # 保存HTML文件
   with open('population.html', 'w') as f:
       f.write(html.data) # 注意这里要用html.data而不是html
   
   
   # import pandas as pd
   # import pycountry
   # import bar_chart_race as bcr
   # import flag as ecf
   
   # # 创建数据框
   # df = pd.DataFrame({
   #     'year': [1960, 1965, 1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010, 2015, 2020],
   #     'China': [667070000, 715185000, 818315000, 916395000, 981235000, 1058510000, 1135185000, 1210855000, 1262645000, 1299940000, 1340960000, 1371220000, 1397715000],
   #     'India': [449480000, 494798000, 553578000, 621301000, 696783000, 781596000, 873277000, 960581000, 1038739000, 1101832000, 1173109000, 1310152000, 1380004000],
   #     'USA': [180671000, 194303000, 209513000, 215973000, 227225000, 238466000, 249623000 ,262803000 ,282162411 ,295516599 ,309349689 ,321418820 ,331002651],
   #     'Indonesia': [87792512 ,99028000 ,114793178 ,136725000 ,164982451 ,181413402 ,197577430 ,211540428 ,214448875 ,222781023 ,237641326 ,257563815 ,273523615],
   #     'Brazil': [72179226 ,82869700 ,95113265 ,107216205 ,121740438 ,135274080 ,149003223 ,161790182 ,174790340 ,184010409 ,194946470 ,204471769 ,212559417],
   #     'Russia': [119897000 ,125345604 ,129941789 ,137403041 ,138647248 ,141668836 ,148375787 ,147915361 ,146596557 ,143953092 ,142849449 ,143455918 ,145934462],
   #     'Mexico': [38174112 ,46111000 ,55984294.6 ,63759976.8 ,68434628.7 ,75895675.8 ,84473739.9 ,93007627.1 ,98864658.4 ,103263388.2 ,107449525.4 ,119938473.1 ,128932753],
   #     'Germany': [72814900.2,75695073.7,78169289.5,78688452,78288576,77718298,79433029,81678051,82211508,82431390,81776930,81686611,83783942],
   #     'UK': [52410496,53292000,55632000,56079000,56314216,56333829,57442167,58487141,58892514,60401206,62766365,65110034,67886011],
   #     'Japan': [92500572,98676292,104345817,111940314,117060396,121048923,123611167,125757788,126843659,127767994,128057352,127131800,126476461]
   # })
   
   # # 设置索引为年份
   # df = df.set_index('year')
   
   # # 创建国家代码和国旗图标的字典
   # countries = df.columns
   # name_to_code = {
   #  'China': 'CHN',
   #  'India': 'IND',
   #  'USA': 'USA',
   #  'Indonesia': 'IDN',
   #  'Brazil': 'BRA',
   #  'Russia': 'RUS',
   #  'Mexico': 'MEX',
   #  'Germany': 'DEU',
   #  'UK': 'GBR',
   #  'Japan': 'JPN'
   # }
   
   # # 用字典中的代码替换国家名称
   # codes = []
   # flags = []
   # for country in countries:
   #  code = name_to_code[country] # 获取国家的三位字母代码
   #  codes.append(code)
   #  flag = ecf.flag(code) # 使用emoji_country_flag库转换代码为国旗图标
   #  flags.append(flag)
   
   # # 创建一个新的数据框，用国旗图标替换国家名称
   # df_flags = df.copy()
   # df_flags.columns = flags
   
   # # 制作动态人口数量排行榜，并保存为视频文件
   # bcr.bar_chart_race(
   #  df=df_flags,
   #  filename='population.mp4',
   #  # 设置一些参数
   #  n_bars=10, # 显示十个国家
   #  steps_per_period=10, # 每个时间段显示十帧
   #  period_length=500, # 每个时间段持续500毫秒
   #  title='Population——2021300959 cang', # 设置标题
   #  figsize=(8, 5), # 设置图形大小
   #  bar_label_size=7, # 设置条形图标签的字体大小
   #  tick_label_size=7, # 设置刻度标签的字体大小
   #  bar_kwargs={'alpha': 0.7}, # 设置条形图的透明度
   #  filter_column_colors=True # 设置条形图的颜色根据国旗图标变化，这是关键参数！
   # )
   
   ```

   *一种为mp4，一种为html文件，可能会存在显示错误*





2. **无国旗标志**

```python
import pandas as pd
import bar_chart_race as bcr

# 读取数据
df = pd.DataFrame({
    'year': [1960, 1965, 1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010, 2015, 2020],
    'China': [667070000, 715185000, 818315000, 916395000, 981235000, 1058510000, 1135185000, 1210855000, 1262645000, 1299940000, 1340960000, 1371220000, 1397715000],
    'India': [449480000, 494798000, 553578000, 621301000, 696783000, 781596000, 873277000, 960581000, 1038739000, 1101832000, 1173109000, 1310152000, 1380004000],
    'USA': [180671000, 194303000, 209513000, 215973000, 227225000, 238466000, 249623000 ,262803000 ,282162411 ,295516599 ,309349689 ,321418820 ,331002651],
    'Indonesia': [87792512 ,99028000 ,114793178 ,136725000 ,164982451 ,181413402 ,197577430 ,211540428 ,214448875 ,222781023 ,237641326 ,257563815 ,273523615],
    'Brazil': [72179226 ,82869700 ,95113265 ,107216205 ,121740438 ,135274080 ,149003223 ,161790182 ,174790340 ,184010409 ,194946470 ,204471769 ,212559417],
    'Russia': [119897000 ,125345604 ,129941789 ,137403041 ,138647248 ,141668836 ,148375787 ,147915361 ,146596557 ,143953092 ,142849449 ,143455918 ,145934462],
    'Mexico': [38174112 ,46111000 ,55984294.6 ,63759976.8 ,68434628.7 ,75895675.8 ,84473739.9 ,93007627.1 ,98864658.4 ,103263388.2 ,107449525.4 ,119938473.1 ,128932753],
    'Germany': [72814900.2,75695073.7,78169289.5,78688452,78288576,77718298,79433029,81678051,82211508,82431390,81776930,81686611,83783942],
    'UK': [52410496,53292000,55632000,56079000,56314216,56333829,57442167,58487141,58892514,60401206,62766365,65110034,67886011],
    'Japan': [92500572,98676292,104345817,111940314,117060396,121048923,123611167,125757788,126843659,127767994,128057352,127131800,126476461]
})
# 设置索引为年份
df = df.set_index('year')

# 创建国家代码和国旗图标的字典
countries = df.columns
name_to_code = {
    'China': 'CHN',
    'India': 'IND',
    'USA': 'USA',
    'Indonesia': 'IDN',
    'Brazil': 'BRA',
    'Russia': 'RUS',
    'Mexico': 'MEX',
    'Germany': 'DEU',
    'UK': 'GBR',
    'Japan': 'JPN'
}

# 用字典中的代码替换国家名称
codes = []
flags = []
for country in countries:
 code = name_to_code[country] # 获取国家的三位字母代码
 codes.append(code)


# 制作动态条形图
bcr.bar_chart_race(
 df=df,
 filename='世界人口.mp4',
 # 设置一些参数
 n_bars=10, # 显示前十个国家
 steps_per_period=10, # 每个时间段显示十帧
 period_length=500, # 每个时间段持续500毫秒
 title='Population——2021300959 cang', # 设置标题
 figsize=(8, 5), # 设置图形大小
 bar_label_size=7, # 设置条形图标签的字体大小
 tick_label_size=7, # 设置刻度标签的字体大小
 bar_kwargs={'alpha': 0.7}, # 设置条形图的透明度
)
```